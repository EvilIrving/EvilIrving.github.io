import{_ as s,c as e,o as a,V as n}from"./chunks/framework.9b470ccc.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"library/reading/在同一台电脑上配置多个SSH Key.md","filePath":"library/reading/在同一台电脑上配置多个SSH Key.md","lastUpdated":1691073737000}'),l={name:"library/reading/在同一台电脑上配置多个SSH Key.md"},t=n(`<h2 id="在同一台电脑上配置多个ssh-key" tabindex="-1">在同一台电脑上配置多个SSH Key <a class="header-anchor" href="#在同一台电脑上配置多个ssh-key" aria-label="Permalink to &quot;在同一台电脑上配置多个SSH Key&quot;">​</a></h2><p><code>SSH Key</code> 是克隆代码的授权标识，全平台唯一，代表的是一个账号。每个平台账号配置的 <code>SSH key</code> 需要不同，才能标识到人，对应人员操作的权限和审计。在一些场景下，需要在同一台电脑上同时管理多个平台账号</p><h3 id="设置-ssh-key" tabindex="-1">设置 <code>SSH key</code> <a class="header-anchor" href="#设置-ssh-key" aria-label="Permalink to &quot;设置 \`SSH key\`&quot;">​</a></h3><ol><li><p>生成<code>SSH key</code></p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">ssh-keygen -t rsa -C &quot;&lt;您的邮箱&gt;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Generating public/private rsa key pair.</span></span>
<span class="line"><span style="color:#A6ACCD;">Enter file in which to save the key (~/.ssh/id_rsa):&lt;为了区分多个key，请填写自定义的名称&gt;</span></span></code></pre></div><blockquote><p>说明 为了区分多个 <code>SSH key</code>，以上第3行请不要直接回车，请填写自定义的 key 路径名称以方便后续使用，如 <code>gitee_rsa</code>，<code>github_rsa</code>，然后点击回车确认。</p></blockquote></li><li><p>添加<code>id_rsa</code></p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">ssh-add ~/.ssh/id_rsa</span></span></code></pre></div><ul><li>测试本地是否添加成功</li></ul><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">ssh -T git@gitee.com</span></span></code></pre></div></li><li><p>添加到平台</p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">cat ~/.ssh/id_rsa.pub</span></span></code></pre></div><p>登录平台账号A，点击页面右上角头像 - 个人设置 -「SSH 密钥」展现 SSH 密钥设置弹窗。将 <code>1</code> 中<code>*.pub</code>的公钥粘贴到输入框中保存。</p><p>切换至平台账号B，将 <code>1</code> 中生成的另一个公钥同样配置到账号下。</p></li><li><p>编辑~/.ssh/config文件</p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># 账号A</span></span>
<span class="line"><span style="color:#A6ACCD;">Host gitee</span></span>
<span class="line"><span style="color:#A6ACCD;">HostName gitee.com</span></span>
<span class="line"><span style="color:#A6ACCD;">IdentityFile ~/.ssh/gitee_rsa</span></span>
<span class="line"><span style="color:#A6ACCD;">PreferredAuthentications publickey</span></span>
<span class="line"><span style="color:#A6ACCD;">IdentityAgent none</span></span>
<span class="line"><span style="color:#A6ACCD;">IdentitiesOnly yes</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># 账号B</span></span>
<span class="line"><span style="color:#A6ACCD;">Host github</span></span>
<span class="line"><span style="color:#A6ACCD;">HostName github.com</span></span>
<span class="line"><span style="color:#A6ACCD;">IdentityFile ~/.ssh/github_rsa</span></span>
<span class="line"><span style="color:#A6ACCD;">PreferredAuthentications publickey</span></span>
<span class="line"><span style="color:#A6ACCD;">IdentityAgent none</span></span>
<span class="line"><span style="color:#A6ACCD;">IdentitiesOnly yes</span></span></code></pre></div><ul><li>HostName：填写托管平台服务地址；</li><li>Host：填写别名，方便命令行使用；</li><li>IdentityFile：填写证书位置；</li></ul></li><li><p>命令行操作</p><p>在日常推拉代码工作时，获取代码库的 <code>ssh</code> 克隆地址后，因为本地有多个账号，可以手动选择使用哪个账号操作。</p><p>以示例库举例，假设克隆地址为：<code>git@gitee.com:me/Codeup-Demo.git</code>。</p><p>那么可以使用如下命令切换账号：</p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">git@gitee:me/Codeup-Demo.git</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">git@github:me/Codeup-Demo.git</span></span></code></pre></div></li></ol><h3 id="报错" tabindex="-1">报错 <a class="header-anchor" href="#报错" aria-label="Permalink to &quot;报错&quot;">​</a></h3><blockquote><p>Could not open a connection to your authentication agent 尝试重启SSH服务</p></blockquote><ol><li><p>修改服务：</p><p>以<strong>管理员身份</strong>运行命令提示符，并输入以下命令：</p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">net stop sshd</span></span>
<span class="line"><span style="color:#A6ACCD;">net start sshd</span></span></code></pre></div></li><li><p>使用服务管理器：</p></li></ol><ul><li>打开 Windows 服务管理器。可以在 Windows 搜索栏中搜索“服务”并点击打开。</li><li>找到 OpenSSH Authentication Agent 和 OpenSSH SSH Server。</li><li>右键点击服务并选择“重启”。</li></ul><blockquote><p>Permission denied (publickey)</p></blockquote><p>可能缺少第二步，重新按流程走一遍，如果不行，尝试以下：</p><ul><li><code>cat /etc/ssh/sshd_config</code> 查看SSH服务对应配置文件，修改<code>PasswordAuthentication: no</code>为：<code>yes</code></li></ul>`,11),o=[t];function p(i,c,d,r,y,h){return a(),e("div",null,o)}const A=s(l,[["render",p]]);export{u as __pageData,A as default};
